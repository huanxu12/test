# **MineSLAM 项目详细需求文档 (Project Requirements Document) v5.0**

## **1. 项目总览 (Overview)**

### **1.1 项目名称**
**MineSLAM** – 面向矿井退化环境的多模态自适应三维语义 SLAM 系统

### **1.2 项目目标**
开发一套能够在极端矿井场景中（高粉尘、低光照、重复拓扑、多传感器退化），依然稳定输出6-DoF位姿、构建高精度三维语义地图、并实时检测人员位置的智能软件系统。系统需满足：
- 实时性：端到端帧率 ≥ 10 Hz
- 鲁棒性：单一模态失效下仍可保持位姿漂移率 < 20%
- 可移植性：部署到 Jetson AGX Orin 进行实地验证

---

## **2. 场景与问题定义 (Background & Problem Statement)**

### **2.1 应用场景**
- 灾后矿井巷道巡检、人员搜救
- 高粉尘/低照度下的机器人自主导航
- 重复结构巷道的闭环定位和地图构建

### **2.2 挑战**
- **视觉失效**：粉尘与黑暗使相机无法捕捉可靠特征
- **拓扑退化**：激光雷达在重复场景中易回环误匹配
- **多模态退化**：热成像噪声、IMU 漂移、里程计丢失
- **算力受限**：嵌入式平台功耗 ≤ 30W，模型需高效

---

## **3. 硬件与算力约束 (Hardware & Compute Constraints)**
- **训练平台**：RTX 4090 (24GB)，i9 CPU，128GB RAM
- **部署平台**：Jetson AGX Orin，30W 功耗模式，TensorRT 推理
- **实时性目标**：< 100ms 推理延迟
- **模型大小**：< 200 MB，支持 FP16/INT8 量化

---

## **4. 系统架构设计 (System Architecture)**

### **4.1 四层分层架构**
1. **模态编码层 (Encoders)**
   - RGB/深度/热成像：EfficientNet-B0，多尺度特征投影到512维token
   - LiDAR点云：MinkowskiUNet14稀疏卷积，体素大小0.05m
   - IMU：2层LSTM，窗口长度T=20，输出512维运动token

2. **MoE 融合层 (Fusion Layer)**
   - 门控网络：MLP + Softmax，输出几何/语义/视觉权重
   - 专家网络：轻量Transformer，每个2层Encoder，4头注意力
   - 热引导机制：使用热成像mask调整LiDAR注意力分数，引导关注人员区域
   - 降级策略：单模态失效时自动调整权重，保障连续轨迹

3. **任务解码层 (Task Heads)**
   - PoseHead：MLP输出se(3)运动增量
   - DetectionHead：DETR风格，20个物体查询，输出3D边界框和置信度

4. **后端优化与地图构建 (Back-End)**
   - g2o因子图优化，集成自定义语义因子，将检测置信度传递到图优化信息矩阵
   - 输出多层次三维语义地图（几何层+语义层+人员状态）

---

## **5. 算法与训练策略 (Algorithms & Training)**
- **数据集**：DARPA SubT、公开矿井数据集 + 自建标注，含RGB/深度/热成像/LiDAR/IMU
- **标注规范**：3D边界框，IoU ≥ 0.7
- **损失函数**：
  - L_total = L_pose + λ1·L_det + λ2·L_gate
  - λ 通过不确定性加权自适应调整
- **数据增强**：随机遮挡、点云噪声注入、时序扰动
- **训练技巧**：混合精度训练，梯度累积，余弦退火学习率调度

---

## **6. 测试与评估 (Testing & Evaluation)**
- **单模态退化测试**：模拟RGB、LiDAR、热成像单独失效
- **多模态联合退化**：测试MoE动态权重调整能力
- **性能指标**：
  - 定位精度：ATE < 1.0 m，RPE < 1%
  - 探测性能：3D mAP@0.5 ≥ 70%
  - 系统实时性：端到端帧率 ≥ 10 Hz
  - 鲁棒性：丢帧率 10% 时轨迹误差增长率 < 20%

---

## **7. 创新点 (Innovations)**
- 引入MoE动态专家融合，解决多模态失效下的权重分配问题
- 首次提出热成像引导的LiDAR注意力机制，增强人员探测能力
- 将前端感知不确定性显式传递到后端因子图优化，实现感知-优化一体闭环

---

## **8. 风险与对策 (Risks & Mitigation)**
- **数据不足**：使用仿真与合成数据补充，域自适应训练
- **算力不足**：稀疏化+模型剪枝+量化，优化推理速度
- **传感器失效**：增加健康监测模块，触发回退模式

---

## **9. 可视化与API设计 (Visualization & API)**
- **界面设计**：3D点云叠加语义信息，实时显示人员热力图和ID
- **接口**：ROS2 + RESTful，提供位姿、地图、人员状态实时订阅

---

## **10. 部署与验证计划 (Deployment & Validation)**
1. RTX 4090 完成离线训练与验证
2. 导出ONNX，TensorRT量化部署到Jetson Orin
3. 机器人实地实验：矿井场景全流程测试，评估精度、鲁棒性、实时性

